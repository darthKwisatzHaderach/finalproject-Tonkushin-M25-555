INFO 2025-11-16T12:17:06 Тестовое сообщение
WARNING 2025-11-16T12:17:06 Предупреждение
ERROR 2025-11-16T12:17:06 Ошибка
INFO 2025-11-16T12:17:09 REGISTER user='test_user_log' result=OK
INFO 2025-11-16T12:17:09 LOGIN user='alice' result=OK
INFO 2025-11-16T12:17:09 BUY user='alice' currency='EUR' amount=10.00 rate=1.10 balance=160.00→170.00 EUR result=OK
INFO 2025-11-16T12:17:09 SELL user='alice' currency='EUR' amount=5.00 rate=1.10 balance=170.00→165.00 EUR result=OK
INFO 2025-11-16T12:17:12 LOGIN user='alice' result=OK
INFO 2025-11-16T12:17:12 SELL user='alice' currency='BTC' amount=1.0000 result=ERROR error_type='InsufficientFundsError' error_message='Недостаточно средств: доступно 0.1300 BTC, требуется 1.0000 BTC'
INFO 2025-11-16T12:17:12 BUY user='alice' currency='USD' amount=100.00 rate=1.00 balance=1396.17→1496.17 USD result=OK
INFO 2025-11-16T12:17:18 LOGIN user='alice' result=OK
INFO 2025-11-16T12:17:18 BUY user='alice' currency='BTC' amount=0.0100 rate=45000.00 base='USD' balance=0.1300→0.1400 BTC result=OK
INFO 2025-11-16T12:19:07 LOGIN user='alice' result=OK
INFO 2025-11-16T12:19:07 BUY user='alice' currency='XYZ' amount=10.00 result=ERROR error_type='CurrencyNotFoundError' error_message='Неизвестная валюта 'XYZ''
INFO 2025-11-16T12:19:07 BUY user='alice' currency='EUR' amount=10.00 rate=1.10 balance=165.00→175.00 EUR result=OK
INFO 2025-11-16T12:19:07 SELL user='alice' currency='BTC' amount=1.0000 result=ERROR error_type='InsufficientFundsError' error_message='Недостаточно средств: доступно 0.1400 BTC, требуется 1.0000 BTC'
INFO 2025-11-16T12:19:32 LOGIN user='alice' result=OK
INFO 2025-11-16T12:19:32 BUY user='alice' currency='BTC' amount=0.0100 rate=45000.00 balance=0.1400→0.1500 BTC result=OK
INFO 2025-11-16T12:19:32 SELL user='alice' currency='BTC' amount=0.0050 rate=45000.00 balance=0.1500→0.1450 BTC result=OK
INFO 2025-11-16T12:21:09 LOGIN user='alice' result=OK
INFO 2025-11-16T12:21:09 BUY user='alice' currency='EUR' amount=10.00 rate=1.10 balance=175.00→185.00 EUR result=OK
INFO 2025-11-16T12:21:09 BUY user='alice' currency='XYZ' amount=10.00 result=ERROR error_type='CurrencyNotFoundError' error_message='Неизвестная валюта 'XYZ''
INFO 2025-11-16T12:21:09 SELL user='alice' currency='EUR' amount=5.00 rate=1.10 balance=185.00→180.00 EUR result=OK
INFO 2025-11-16T12:21:15 LOGIN user='alice' result=OK
INFO 2025-11-16T12:21:15 SELL user='alice' currency='BTC' amount=1.0000 result=ERROR error_type='InsufficientFundsError' error_message='Недостаточно средств: доступно 0.1450 BTC, требуется 1.0000 BTC'
INFO 2025-11-16T12:21:57 LOGIN user='alice' result=OK
INFO 2025-11-16T12:21:57 BUY user='alice' currency='EUR' amount=5.00 rate=1.10 balance=180.00→185.00 EUR result=OK
INFO 2025-11-16T12:21:57 SELL user='alice' currency='EUR' amount=2.00 rate=1.10 balance=185.00→183.00 EUR result=OK
INFO 2025-11-16T12:24:17 LOGIN user='alice' result=OK
INFO 2025-11-16T12:24:17 BUY user='alice' currency='EUR' amount=5.00 rate=1.10 balance=183.00→188.00 EUR result=OK
INFO 2025-11-16T19:43:25 REGISTER user='demo_user' result=OK
INFO 2025-11-16T19:43:31 LOGIN user='demo_user' result=OK
INFO 2025-11-16T19:43:39 Начало обновления курсов валют
INFO 2025-11-16T19:43:39 Запрос курсов от CoinGeckoClient
INFO 2025-11-16T19:43:39 CoinGeckoClient: получено 3 курсов
ERROR 2025-11-16T19:43:39 CoinGeckoClient: Неожиданная ошибка - [Errno 2] No such file or directory: '/Users/dmitriytonkusin/Mephi/data/exchange_rates.tmp'
Traceback (most recent call last):
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/updater.py", line 96, in run_update
    self.storage.save_rate_to_history(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        from_currency=from_currency,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        },
        ^^
    )
    ^
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/storage.py", line 68, in save_rate_to_history
    self._save_history_atomic(history_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/storage.py", line 155, in _save_history_atomic
    with open(temp_file, "w", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/Users/dmitriytonkusin/Mephi/data/exchange_rates.tmp'
INFO 2025-11-16T19:43:39 Запрос курсов от ExchangeRateApiClient
ERROR 2025-11-16T19:43:39 ExchangeRateApiClient: Ошибка при обращении к внешнему API: API-ключ для ExchangeRate-API не установлен. Установите переменную окружения EXCHANGERATE_API_KEY
INFO 2025-11-16T19:43:39 Обновление кэша: 1 пар валют
INFO 2025-11-16T19:46:26 REGISTER user='demo_user' result=ERROR error_type='ValueError' error_message='Имя пользователя 'demo_user' уже занято'
INFO 2025-11-16T19:47:41 REGISTER user='demo_user' result=ERROR error_type='ValueError' error_message='Имя пользователя 'demo_user' уже занято'
INFO 2025-11-16T19:50:14 REGISTER user='demo_user' result=OK
INFO 2025-11-16T19:50:20 LOGIN user='demo_user' result=OK
INFO 2025-11-16T19:50:28 Начало обновления курсов валют
INFO 2025-11-16T19:50:28 Запрос курсов от CoinGeckoClient
INFO 2025-11-16T19:50:28 CoinGeckoClient: получено 3 курсов
ERROR 2025-11-16T19:50:28 CoinGeckoClient: Неожиданная ошибка - [Errno 2] No such file or directory: '/Users/dmitriytonkusin/Mephi/data/exchange_rates.tmp'
Traceback (most recent call last):
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/updater.py", line 96, in run_update
    self.storage.save_rate_to_history(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        from_currency=from_currency,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        },
        ^^
    )
    ^
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/storage.py", line 68, in save_rate_to_history
    self._save_history_atomic(history_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/storage.py", line 155, in _save_history_atomic
    with open(temp_file, "w", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/Users/dmitriytonkusin/Mephi/data/exchange_rates.tmp'
INFO 2025-11-16T19:50:28 Запрос курсов от ExchangeRateApiClient
INFO 2025-11-16T19:50:28 ExchangeRateApiClient: получено 0 курсов
INFO 2025-11-16T19:50:28 Обновление кэша: 1 пар валют
INFO 2025-11-16T19:51:11 Начало обновления курсов валют
INFO 2025-11-16T19:51:11 Запрос курсов от CoinGeckoClient
INFO 2025-11-16T19:51:12 CoinGeckoClient: получено 3 курсов
ERROR 2025-11-16T19:51:12 CoinGeckoClient: Неожиданная ошибка - argument of type 'NoneType' is not iterable
Traceback (most recent call last):
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/updater.py", line 96, in run_update
    self.storage.save_rate_to_history(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        from_currency=from_currency,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        },
        ^^
    )
    ^
  File "/Users/dmitriytonkusin/Mephi/finalproject_Tonkushin_M25-555/valutatrade_hub/parser_service/storage.py", line 63, in save_rate_to_history
    if "records" not in history_data:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable
INFO 2025-11-16T19:51:12 Запрос курсов от ExchangeRateApiClient
ERROR 2025-11-16T19:51:12 ExchangeRateApiClient: Ошибка при обращении к внешнему API: API-ключ для ExchangeRate-API не установлен. Установите переменную окружения EXCHANGERATE_API_KEY
INFO 2025-11-16T19:51:12 Обновление кэша: 2 пар валют
INFO 2025-11-16T19:51:12 Обновление завершено: 2 пар, ошибок: 2
INFO 2025-11-16T19:51:29 Начало обновления курсов валют
INFO 2025-11-16T19:51:29 Запрос курсов от CoinGeckoClient
INFO 2025-11-16T19:51:29 CoinGeckoClient: получено 3 курсов
INFO 2025-11-16T19:51:29 Запрос курсов от ExchangeRateApiClient
ERROR 2025-11-16T19:51:29 ExchangeRateApiClient: Ошибка при обращении к внешнему API: API-ключ для ExchangeRate-API не установлен. Установите переменную окружения EXCHANGERATE_API_KEY
INFO 2025-11-16T19:51:29 Обновление кэша: 3 пар валют
INFO 2025-11-16T19:51:43 Начало обновления курсов валют
INFO 2025-11-16T19:51:43 Запрос курсов от CoinGeckoClient
INFO 2025-11-16T19:51:43 CoinGeckoClient: получено 3 курсов
INFO 2025-11-16T19:51:43 Запрос курсов от ExchangeRateApiClient
ERROR 2025-11-16T19:51:43 ExchangeRateApiClient: Ошибка при обращении к внешнему API: API-ключ для ExchangeRate-API не установлен. Установите переменную окружения EXCHANGERATE_API_KEY
INFO 2025-11-16T19:51:43 Обновление кэша: 3 пар валют
INFO 2025-11-16T19:51:43 Обновление завершено: 3 пар, ошибок: 1
INFO 2025-11-16T19:54:17 REGISTER user='demo_user' result=OK
INFO 2025-11-16T19:54:22 LOGIN user='demo_user' result=OK
INFO 2025-11-16T19:54:28 Начало обновления курсов валют
INFO 2025-11-16T19:54:28 Запрос курсов от CoinGeckoClient
INFO 2025-11-16T19:54:29 CoinGeckoClient: получено 3 курсов
INFO 2025-11-16T19:54:29 Запрос курсов от ExchangeRateApiClient
INFO 2025-11-16T19:54:29 ExchangeRateApiClient: получено 0 курсов
INFO 2025-11-16T19:54:29 Обновление кэша: 3 пар валют
INFO 2025-11-16T19:54:29 Обновление завершено: 3 пар, ошибок: 0
INFO 2025-11-16T19:55:02 BUY user='unknown' currency='BTC' amount=0.0010 result=ERROR error_type='RuntimeError' error_message='Необходимо войти в систему'
